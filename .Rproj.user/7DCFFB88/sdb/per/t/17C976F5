{
    "collab_server" : "",
    "contents" : "rm(list=ls())\nlibrary(shiny)\nlibrary(ggplot2)\n\nall<-read.csv(\"All.csv\",sep=\",\",header=TRUE,stringsAsFactors=FALSE)\nall<-na.omit(all)\n\nrunApp(list(\n  ui = fluidPage(\n    column(4,\n           selectInput(\"select1\",label=\"Category\",choices=unique(all$Category),selected=\"Economy\"),\n           br(),\n           selectInput(\"select2\",label=\"Indicator\",choices=\"\")\n    ),\n    column(8, plotOutput(\"p\"))\n  ),\n\n  server = function(input, output, session) {\n    indicator<-reactive({\n      unique(all[all[,\"Category\"]==input$select1,\"Indicator\"])\n    })\n\n    observeEvent(input$select1,{\n      updateSelectInput(session,\"select2\",choices=indicator())\n    })\n\n    category<-reactive({\n      all[all[,\"Category\"]==input$select1,]\n    })\n\n    indicatorgrey<-reactive({\n      category()[category()$Indicator!=input$select2,]\n    })\n\n    indicatorred<-reactive({\n      category()[category()$Indicator==input$select2,]\n    })\n\n    p<-eventReactive(input$select2,{\n      ggplot()+\n        geom_line(data=indicatorgrey(),aes(x=Year,y=Value,group=Indicator),colour=\"grey\",size=0.5,alpha=0.5)+\n        geom_line(data=indicatorred(),aes(x=Year,y=Value,group=Indicator),colour=\"red\",size=1)+\n        facet_wrap(~Province)+\n        theme_gray()+\n        labs(x=\"\",y=\"\",title=\"Comparsion of Chinese Provinces\",\n             caption=\"Source: China Water Risk\")+\n        theme(panel.grid.major.x=element_blank(),\n              panel.grid.minor.x=element_blank(),\n              panel.grid.minor.y=element_blank(),\n              strip.background=element_rect(fill=\"white\"),\n              strip.text=element_text(color=\"black\"),\n              # axis.title.y=element_blank(),\n              axis.text.y=element_blank(),\n              axis.ticks.y=element_blank(),\n              axis.ticks.x=element_blank(),\n              plot.caption=element_text(hjust=0),\n              legend.position=\"none\")\n    })\n    output$p <- renderPlot({\n      p()\n    })\n  }\n))\n",
    "created" : 1502416960556.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4100655406",
    "id" : "17C976F5",
    "lastKnownWriteTime" : 1502436617,
    "last_content_update" : 1502436617699,
    "path" : "C:/Users/User/Google Drive/CWR/R/test.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}