indexArray[1] <- i
#######################
if (n == 1) {
res <- indexArray
} else {
# since indexArray is not a dataframe, use rbind instead of rbindlist
res <- rbind(res, indexArray)
}
message(n)
n <- n + 1
}
rownames(res) <- NULL
return(res)
}
getIndexData <- function(){
#creat an index pool
indexPool <- data.frame(index = c('CSI_100', 'SSE_50', 'CSI_300', 'SSE_Central_SOEs_50',
'HSI', 'HSCEI'),
url = c('http://vip.stock.finance.sina.com.cn/corp/go.php/vII_NewestComponent/indexid/000903.phtml',
'http://vip.stock.finance.sina.com.cn/corp/go.php/vII_NewestComponent/indexid/000016.phtml',
'http://vip.stock.finance.sina.com.cn/corp/go.php/vII_NewestComponent/indexid/000300.phtml',
'http://vip.stock.finance.sina.com.cn/corp/go.php/vII_NewestComponent/indexid/000042.phtml',
'https://www.etnet.com.hk/www/tc/stocks/indexes_detail.php?subtype=HSI',
'https://www.etnet.com.hk/www/tc/stocks/indexes_detail.php?subtype=CEI'
)
)
indexData <- getIndexConstnt(indexPool)
return(indexData)
}
getIndex('002202', indexData)
getIndex('00902', indexData)
getIndex('00991', indexData)
getIndex('600188', indexData)
getIndex('601898', indexData)
getIndex('601088', indexData)
getIndex('01088', indexData)
getIndex('900948', indexData)
getIndex('601717', indexData)
a <- read.table('clipboard', colClasses = 'character')
a
b <- getTickers(a)
write.table(b, file, fileEncoding = 'UTF-8', sep = ',', row.names = F)
a
a <- read.table('clipboard', colClasses = 'character')
a
as.character(a)
is.numeric(a)
is.factor(a)
a
c <- getIndex(a, indexData)
c
write.table(c, file, fileEncoding = 'UTF-8', sep = ',', row.names = F)
a <- read.table('clipboard', colClasses = 'character')
a
b <- getTickers(a)
write.table(b, file, fileEncoding = 'UTF-8', sep = ',', row.names = F)
a <- read.table('clipboard', colClasses = 'character')
a
c <- getIndex(a, indexData)
write.table(c, file, fileEncoding = 'UTF-8', sep = ',', row.names = F)
devtools::check()
install.packages('V8')
devtools::check()
devtools::document()
devtools::document()
devtools::document()
devtools::check()
getIndex('02238', indexData)
getIndex('601633', indexData)
getIndex('01211', indexData)
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
url <- 'http://stockdata.stock.hexun.com/zrbg/data/zrbList.aspx?'
data <- '2015-12-31'
date <- '2015-12-31'
proxy <- NULL
res <- GET(url, query = list(date = date,
count = 20,
pname = 20,
titType = 'null',
page = page), use_proxy(proxy[1, 1], proxy[1, 2]), timeout(15))
library(httr)
res <- GET(url, query = list(date = date,
count = 20,
pname = 20,
titType = 'null',
page = page), use_proxy(proxy[1, 1], proxy[1, 2]), timeout(15))
res
url
page <- 3
res <- GET(url, query = list(date = date,
count = 20,
pname = 20,
titType = 'null',
page = page), use_proxy(proxy[1, 1], proxy[1, 2]), timeout(15))
res
b <- content(res)
b
library(stringi)
c <- stri_replace_first_fixed('hxbase_json1({sum:3165,', '{')
c <- stri_replace_first_fixed(b, 'hxbase_json1({sum:3165,', '{')
c
tail(c)
b
d <- stri_replace_last_fixed(c, ")", "")
d
fromJSON(d)
library(jsonlite)
fromJSON(d)
c
b
c <- stri_replace_first_fixed(b, 'hxbase_json1({sum:3165,list', '\"list\"')
c
d <- paste('{', c, '}', sep = '')
d
fromJSON(d)
stockName <- 600601
url1 <- 'http://so.hexun.com/ajax.do?key='
url2 <- '&type=all?math=0.6109926008061326'
url <- paste(url1, stockName, url2, sep = '')
res <- content(GET(url), as = 'text') %>%
stri_replace_first_fixed("hxSuggest_JsonData=", "\"list\":")
library(rvest)
res <- content(GET(url), as = 'text') %>%
stri_replace_first_fixed("hxSuggest_JsonData=", "\"list\":")
res
a
b
library(devtools)
devtools::install_github('Yuanchao-Xu/gfer')
library(gfer)
a <- read.table('clipboard')
?read.table
a <- read.table('clipboard', colClasses = 'character')
a
b <- getTickers(a)
file <- file.choose()
write.table(b, file)
write.table(b, file, row.names = F)
write.table(b, file, row.names = F, sep = ',')
a <- read.table('clipboard', colClasses = 'character')
a
c <- getIndex(a)
devtools::install_github('Yuanchao-Xu/gfer')
c <- getIndex(a)
library(gfer)
c <- getIndex(a)
gfer::getIndex
devtools::document
devtools::document()
devtools::install_github('Yuanchao-Xu/gfer')
library(gfer)
c <- getIndex(a)
a <- read.table('clipboard', colClasses = 'character')
c <- getIndex(a)
indexData <- getIndexData()
c <- getIndex(a, indexData)
c
write.table(c, file, row.names = F, sep = ',')
c
write.table(c, file, row.names = F, sep = ',')
file <- file.choose()
write.table(c, file, row.names = F, sep = ',')
as.character(0563)
getIndex('0836', indexData)
getIndex('0386', indexData)
getIndex('00386', indexData)
getIndex('601808', indexData)
getIndex('02883', indexData)
getIndex('00857', indexData)
a <- read.table('clipboard', colClasses = 'character')
b <- getTickers(a)
write.table(b, file, row.names = F, sep = ',')
a <- read.table('clipboard', colClasses = 'character')
a
c <- getIndex(a, indexData)
write.table(c, file, row.names = F, sep = ',')
getIndex('0034', indexData)
getIndex('00347', indexData)
getIndex('600362', indexData)
getIndex('600808', indexData)
getIndex('00323', indexData)
getIndex('601600', indexData)
getIndex('02600', indexData)
getIndex('601618', indexData)
getIndex('601005', indexData)
getIndex('601899', indexData)
a <- read.table('clipboard', colClasses = 'character')
file
a <- read.table('clipboard', colClasses = 'character')
a
a
b <- getHisMktCap(a, 20151203, 20151203)
b
write.table(b, file, row.names = F, sep = ',')
b <- getHisMktCap(600900, 20151203, 20151203)
getHisMktCap(600900, 20151203, 20151203)
getHisMktCap(600900, 20161203, 20161203)
getHisMktCap(600900, 20161204, 20161204)
getHisMktCap(600900, 20161205, 20161205)
getHisMktCap(000027, 20161205, 20161205)
getHisMktCap('000027', 20161205, 20161205)
a <- read.table('clipboard', colClasses = 'character')
a
b <- getHisMktCap(a, 20151203, 20151203)
x <- 00568
x
b
write.table(b, file, row.names = F, sep = ',')
a <- read.table('clipboard', colClasses = 'character')
a
b <- getHisMktCap(a, 20151203, 20151203)
write.table(b, file, row.names = F, sep = ',')
getHisMktCap('000061', 20161205, 20161205)
getHisMktCap('002299', 20161205, 20161205)
a <- read.table('clipboard', colClasses = 'character')
a
b <- getHisMktCap(a, 20151203, 20151203)
b
write.table(b, file, row.names = F, sep = ',')
getHisMktCap('000625', 20161205, 20161205)
getHisMktCap('000800', 20161205, 20161205)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, 20151203, 20151203)
write.table(b, file, row.names = F, sep = ',')
a <- read.table('clipboard', colClasses = 'character')
a
b <- getHisMktCap(a, 20151203, 20151203)
write.table(b, file, row.names = F, sep = ',')
getHisMktCap('00001', 20151203, 20151203)
getHisMktCap('1000695', 20151203, 20151203)
getHisMktCap('1002110', 20151203, 20151203)
getHisMktCap('2110', 20151203, 20151203)
ticker <- '001122'
substr(ticker,1)
substr(ticker,1,1)
substr(ticker,1,1) == 0
substr(ticker,1,1) == '0'
devtools::document()
devtools::check()
devtools::install_github('Yuanchao-Xu/gfer')
library(gfer)
getHisMktCap('000695', 20151203, 20151203)
devtools::check()
install.packages('knitr')
devtools::check()
devtools::install_github('Yuanchao-Xu/gfer')
library(gfer)
getHisMktCap('000695', 20151203, 20151203)
getHisMktCap('000539', 20151203, 20151203)
getHisMktCap('300062', 20151203, 20151203)
substr(ticker, 1, 1) == 0|1
substr(ticker, 1, 1) == 0|1|2
substr(ticker, 1, 2) == 0|1|2
substr(ticker, 1, 2)
substr('600023', 1, 1) == 0|1|2
substr('600023', 1, 1)
6 == 0
6 == 1
6 == 0|2
6 == 0|2|3
devtools::check()
devtools::document()
devtools::check()
getHisMktCap('300062', 20151203, 20151203)
getHisMktCap('122295', 20151203, 20151203)
getTickers('四川川投能源股份有限公司
')
getTickers('四川川投能源股份有限公司')
debug(getTickers_unit)
getTickers('四川川投能源股份有限公司')
secNameSplit
index
b$announcements[[3]]
?warnings
warnings('dafa')
warning('dafa')
devtools::document()
devtools::check()
getTickers('四川川投能源股份有限公司')
getIndex('600674', indexData)
getIndex('600795', indexData)
getTickers('国电电力发展股份有限公司
')
getTickers('国电电力发展股份有限公司')
debug(getTickers_unit)
getTickers('国电电力发展股份有限公司')
b$announcements[[3]]
b$announcements[[1]]
getHisMktCap('002202', 20151203, 20151203)
getHisMktCap('600674', 20151203, 20151203)
getHisMktCap('600795', 20151203, 20151203)
getIndex('002202', indexData)
getHisMktCap('002202', 20151203, 20151203)
getIndex('000027', indexData)
getHisMktCap('000027', 20151203, 20151203)
getHisMktCap('002039', 20151203, 20151203)
getHisMktCap('000690', 20151203, 20151203)
getHisMktCap('000983', 20151203, 20151203)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20151203', '20151203')
write.table(b, file, row.names = F, sep = ',')
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20151203', '20151203')
write.table(b, file, row.names = F, sep = ',')
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20151203', '20151203')
write.table(b, file, row.names = F, sep = ',')
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20151203', '20151203')
write.table(b, file, row.names = F, sep = ',')
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20151203', '20151203')
write.table(b, file, row.names = F, sep = ',')
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20151203', '20151203')
write.table(b, file, row.names = F, sep = ',')
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20141203', '20141203')
?write.table
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20141203', '20141203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20141203', '20141203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20141203', '20141203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20141203', '20141203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20141203', '20141203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20131203', '20131203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20131203', '20131203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20131203', '20131203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20131203', '20131203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20131203', '20131203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20131203', '20131203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20121203', '20121203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20121203', '20121203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20121203', '20121203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20121203', '20121203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20121203', '20121203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
a <- read.table('clipboard', colClasses = 'character')
b <- getHisMktCap(a, '20121203', '20121203')
write.table(b, file, row.names = F, sep = ',', col.names = F)
debug(getTickers_unit)
library(gfer)
debug(getTickers_unit)
debug(getTickers)
getTickers('dalfjdalfas')
str(b)
a <- GET(url)
url <- 'http://suggest3.sinajs.cn/suggest/type=&key=600601&name=suggestdata_1489564633542'
library(httr)
a <- GET(url)
a
str(a)
content(a)
content(a, as='text')
url <- 'http://suggest3.sinajs.cn/suggest/type=&key=002200&name=suggestdata_1489564633542'
a <- GET(url)
content(a, as='text')
url <- 'http://suggest3.sinajs.cn/suggest/type=&key=00001&name=suggestdata_1489564633542'
a <- GET(url)
content(a, as='text')
ticker <- '00001'
url1 <- 'http://suggest3.sinajs.cn/suggest/type=&key='
url2 <- '&name=suggestdata_1489564633542'
url <- paste(url1, i, url2, sep = '')
a <- GET(url)
b <- content(a, as = 'text')
i <- ticker
url <- paste(url1, i, url2, sep = '')
a <- GET(url)
b <- content(a, as = 'text')
b
strsplit(b, split = ',')
strsplit(b, split = ',|\')
strsplit(b, split = ',|\\')
strsplit(b, split = ',|=')
strsplit(b, split = ',')
getTickers('无锡市政公共产业集团有限公司')
getTickers('无锡市文化旅游发展集团有限公司')
str(b)
getTickers('无锡市市政公用产业集团有限公司')
getTickers('无锡市国联发展（集团有限公司）')
getTickers('无锡市国联发展（集团）有限公司')
getTickers('无锡市国联发展（集团）有限公司')
str(b)
url
b$announcements[[3]]
b$announcements[[1]]
sQ
q
getTickers('光大期货有限公司')
getTickers('无锡城市发展集团有限公司')
getTickers('无锡城市发展集团有限公司')
str(b)
devtools::install_github('Yuanchao-Xu/gfer')
getTickers('无锡城市发展集团有限公司')
getTickers('光大期货有限公司')
debug(getTickers)
getTickers('光大期货有限公司')
str(b)
corpName
getTickers('东吴期货有限爱你公司')
getTickers('东吴期货有限公司')
getTickers('东吴期货有限公司')
getTickers('无锡市城市发展有限公司')
getTickers('无锡市城市发展有限公司')
getTickers('东吴期货有限公司')
getTickers('无锡城市发展集团有限公司')
getTickers('无锡市文化旅游发展集团有限公司')
getTickers('无锡市文化旅游发展集团有限公司')
getTickers('无锡市文化旅游发展集团有限公司')
getTickers('无锡市市政公用产业集团有限公司')
getTickers('无锡市市政公用产业集团有限公司')
str(b)
substr(secCode, 1, 2) == "12"
substr(secCode, 1, 2) == "16"
substr(secCode, 1, 2)
secCode
index
b
secNameSplit
index
secName
b$announcements[[3]]
devtools::document()
devtools::check()
devtools::document()
devtools::check()
getTickers('无锡市市政公用产业集团有限公司')
devtools::install_github('Yuanchao-Xu/gfer')
library(gfer)
getTickers('无锡市市政公用产业集团有限公司')
getTickers('无锡市市政公用产业集团有限公司')
getTickers('无锡市市政公用产业集团有限公司')
getTickers('无锡市文化旅游发展集团有限公司')
getTickers('无锡城市发展集团有限公司')
getTickers('中国远洋控股股份有限公司')
getTickers('中国远洋控股股份有限公司')
debug(getTickers)
getTickers('中国远洋控股股份有限公司')
str(b)
b$announcements[[3]]
b$announcements[[3]]
getTickers('中国远洋控股股份有限公司')
b$announcements[[3]]
length(b$announcements)
length(b$announcements) == 0 | length(b$announcements) <
3
b$announcements[[3]]$secName
b$announcements[[3]]
devtools::check()
getTickers('中国远洋控股股份有限公司')
rm(c)
rm(indexData)
rm(a)
rm()
?rm
rm(envir = 'global')
rm(envir = 'Global')
rm(envir = 'Global Environment')
rm(envir = 'gfer')
rm(b)
rm(file)
rm(i)
rm(ticker)
rm(url)
rm(url1)
rm(url2)
rm(x)
